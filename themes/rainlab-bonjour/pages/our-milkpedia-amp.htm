title = "Our Milkpedia Archive"
url = "/amp/milkpedia/:slug"
layout = "basic-amp"
meta_description = "Selamat datang di Milkpedia. Dapatkan informasi seputar nutrisi dan kesehatan serta segala manfaat kebaikan susu yang bermanfaat bagi Anda dan keluarga."
is_hidden = 0

[builderDetails]
modelClass = "Definite\Milkpedia\Models\Category"
identifierValue = "{{ :slug }}"
modelKeyColumn = "slug"
displayColumn = "title"
notFoundMessage = "Record not found"

[milkpediaList]
==
<?php
function onEnd() {
  if( $this->page->components["builderDetails"]->record ){

    // get the post component
    $_title = $this->page->components["builderDetails"]->record->attributes["title"];
    $_title_en = $this->page->components["builderDetails"]->record->attributes["title_en"];
    $_meta_description = $this->page->components["builderDetails"]->record->attributes["meta_description"];
    $_meta_keywords = $this->page->components["builderDetails"]->record->attributes["meta_keywords"];
    $total = $this->page->components["milkpediaList"]->total;


    if($_title == "Kapan & Bagaimana Cara Minum Susu"){
        $this->page->title = "Cara dan Waktu Terbaik Minum Susu";
    } else {
        $this->page->title = $_title;
    }

    $this->page->meta_title = $this->page->components["builderDetails"]->record->attributes["meta_title"];
    $this->page->meta_description = $_meta_description;
    $this->page->meta_keywords = $_meta_keywords;
    
    $this->page->meta_title_en = $this->page->components["builderDetails"]->record->attributes["meta_title_en"];
    $this->page->meta_description_en = $this->page->components["builderDetails"]->record->attributes["meta_description_en"];
    $this->page->meta_keywords_en = $this->page->components["builderDetails"]->record->attributes["meta_keywords_en"];

    $this->page->slug = $this->param('slug');

    $domain_url = (isset($_SERVER['HTTP_USESSL']) || isset($_SERVER['HTTPS']) ? "https" : "http") . "://$_SERVER[HTTP_HOST]$_SERVER[REQUEST_URI]";

    /*
    $domain_url = url('/api/milkpedia?').'slug='.$this->param('slug').'&is_amp=1';
    header("Content-type: application/json");
    header("Access-Control-Allow-Credentials: true");
    header("Access-Control-Allow-Origin: ". str_replace('.', '-', $domain_url) .".cdn.ampproject.org");
    header("AMP-Access-Control-Allow-Source-Origin: " . $domain_url);
    header("Access-Control-Expose-Headers: AMP-Access-Control-Allow-Source-Origin");
    header("AMP-Redirect-To: ".$domain_url);
    header("Access-Control-Expose-Headers: AMP-Redirect-To, AMP-Access-Control-Allow-Source-Origin");
    */

    // pagination
    $this->page->p = Input::get('p', 1);
    if( ! is_numeric($this->page->p)){
      $this->page->p = 1;
    }else if($this->page->p < 1){
      $this->page->p = 1;
    }

    $num_pgn = 5;
    $space_pgn = 2;

    $this->page->total_page = $total / 7;
    $this->page->total_page = (int) ceil($this->page->total_page);
  
    $this->page->max_p = $this->page->p <= $space_pgn ? $num_pgn : $this->page->p + $space_pgn;

    if( $this->page->max_p > $this->page->total_page ){
        $this->page->max_p = $this->page->total_page;
    }

    $this->page->min_p = $this->page->max_p - ($num_pgn - 1);
    if( $this->page->min_p < 1 )
        $this->page->min_p = 1;
  }
}
?>
==
{% set record = builderDetails.record %}
{% set displayColumn = builderDetails.displayColumn %}
{% set notFoundMessage = builderDetails.notFoundMessage %}

{% put head_scripts %}
<script async custom-element="amp-list" src="https://cdn.ampproject.org/v0/amp-list-0.1.js"></script>
<script async custom-element="amp-lightbox" src="https://cdn.ampproject.org/v0/amp-lightbox-0.1.js"></script>

{% endput %}

{% put styles %}
        .lightbox {
          background: rgba(0,0,0,0.8);
          width: 100%;
          height: 100%;
          position: absolute;
          display: flex;
          align-items: center;
          justify-content: center;
          position: relative;
        }
        .lightbox h1 {
          color: white;
        }
        .amp-modal-wrapper-ecom{
            width: 90%;
            margin: 0 auto;
            height: auto;
            background-color: #0f4d9a;
            border-radius: 25px;
            position: relative;
            padding: 3.5vh 0;
        }
        .amp-modal-wrapper-ecom .amp-modal-ecom-title{
            font-size: 5vw;
            text-align: center;
            color: #fff;
            font-weight: 600;
            margin: 10px 0;
        }

        .amp-modal-wrapper-ecom .amp-modal-ecom-list{
            display: flex;
            flex-direction: column;
            width: 90%;
            margin: 0 auto;
        }
        .amp-modal-wrapper-ecom .amp-modal-ecom-list .amp-modal-ecom-btn{
            width: 100%;
            padding: 2.5vw 0;
            background-color: transparent;
            border: 1px solid #fff;
            border-radius: 10px;
            margin: 2.5vw 0;
            color: #fff;
            text-decoration: none;
            text-align: center;
            font-size: 5vw;
            transition: 0.3s;
        }
        .amp-modal-wrapper-ecom .amp-modal-ecom-list .amp-modal-ecom-btn:hover{
            font-size: 7.5vw;
            background-color: #166ad1;
        }

        .lightbox .close{
            position: absolute;
            top: -4%;
            right: -2.5%;
            background: #fff;
            border: 1px solid #000;
            color: #000;
            font-size: 3.5vw;
            border-radius: 50px;
            width: 7.5vw;
            height: 7.5vw;
            font-weight: 700;
            outline: none;
        }
        
        .wrapper-ecom{
            width: 95%;
            margin: 0 auto;
            height: 125px;
            background: url(/storage/app/media/Banner/ecommerce-banner.png);
            background-size: cover;
            background-repeat: no-repeat;
            background-position: 20% 50%;
            margin-bottom: 20px;
            border-radius: 10px;
        }
        .wrapper-ecom .wrapper-ecom-2{
            width: 50%;
            height: 100%;
            display: flex;
            flex-direction: column;
            justify-content: center;    
            margin-left: 20px;
        }
        .wrapper-ecom .wrapper-ecom-2 .ecom-title{
            margin-bottom: 10px;
            color: #0f4d9a;
        }
{% endput %}

<div class="cover">
    {% if this.page.slug == 'kapan-dan-bagaimana-cara-minum-susu' %}
        <amp-img 
            src="{{ 'assets/img/milkypedia/Kapan-dan-bagaimana-cara-minum-susu-Mobile.jpg'|theme }}"
            srcset="{{ 'assets/img/milkypedia/Kapan-dan-bagaimana-cara-minum-susu-Mobile.jpg'|theme }} 640w,
                   {{ 'assets/img/milkypedia/Kapan-dan-bagaimana-cara-minum-susu-Mobile.jpg'|theme }} 320w"
            width="50"
            height="50"
            layout="responsive"
            alt="Kapan dan Bagaimana Cara Minum Susu Mobile">
        </amp-img>
    {% elseif this.page.slug == 'manfaat-minum-susu' %}
        <amp-img 
            src="{{ 'assets/img/milkypedia/Manfaat-Minum-Susu-Mobile.jpg'|theme }}"
            srcset="{{ 'assets/img/milkypedia/Manfaat-Minum-Susu-Mobile.jpg'|theme }} 640w,
                   {{ 'assets/img/milkypedia/Manfaat-Minum-Susu-Mobile.jpg'|theme }} 320w"
            width="50"
            height="50"
            layout="responsive"
            alt="Manfaat Minum Susu Mobile">
        </amp-img>
    {% elseif this.page.slug == 'nutrisi-dan-kesehatan' %}    
        <amp-img 
            src="{{ 'assets/img/milkypedia/Nutrisi-dan-Kesehatan-Mobile.jpg'|theme }}"
            srcset="{{ 'assets/img/milkypedia/Nutrisi-dan-Kesehatan-Mobile.jpg'|theme }} 640w,
                   {{ 'assets/img/milkypedia/Nutrisi-dan-Kesehatan-Mobile.jpg'|theme }} 320w"
            width="50"
            height="50"
            layout="responsive"
            alt="Nutrisi dan Kesehatan Mobile">
        </amp-img>    
    {% else %}
        <amp-img 
            src="{{ 'assets/img/95-TAHUN-FF_mobile-banner.jpg'|theme }}"
            srcset="{{ 'assets/img/95-TAHUN-FF_mobile-banner.jpg'|theme }} 640w,
                   {{ 'assets/img/95-TAHUN-FF_mobile-banner.jpg'|theme }} 320w"
            width="50"
            height="50"
            layout="responsive"
            alt="Banner 95 Tahun Frisian Flag Mobile">
        </amp-img>
    {% endif %}
</div>
    {{key}}
<amp-accordion class="title_home">
    <section>
        <h4 class="arrow_down"><a href="#" target="_self">{{ record.title }}</a></h4>
        <p>
          {% for category in record.all %}
            <a href="{{ category.slug }}" {% if category.slug == record.slug %} class="active" {% endif %} target="_self">{{ trans_pick(category, 'title') }}</a>
          {% endfor %}
          <a href="{{ 'our-milkpedia-faq-amp'|page }}">FAQ</a>
        </p>
    </section>
</amp-accordion>

<div class="breadcrumb">
    <a href="{{ 'home'|page }}">{{ 'beranda'|_ }}</a> /
    <a href="#">Milkpedia</a> /
    <a href="{{ 'our-milkpedia'|page({ "slug": record.slug }) }}">{{ trans_pick(record, 'title') }}</a>
</div>

{% if record %}
    {% set milkpedias = record.posts.take(1) %}
    {% set latest = milkpedias.first() %}

    <div class="detail_text">
        <h1>{{ trans_pick(record, "title") }}</h1>
        
            <div class="text">
                <p>{{ trans_pick(record, "description") | raw}}</p>
            </div>        
        
    </div>

    
    <!-- modal -->
     <amp-lightbox id="ecom-lightbox" layout="nodisplay">
      <div class="lightbox-sustain" role="button" tabindex="0">
          <div class="amp-modal-wrapper-ecom">
              <h2 class="amp-modal-ecom-title">Temukan Product Kami di:</h2>
              <div class="amp-modal-ecom-list">
                <a class="amp-modal-ecom-btn" href="https://www.tokopedia.com/frisian-flag?utm_source=others&utm_medium=brand&utm_campaign=ao_frisianflag_221121_311222" target="_blank">
                    tokopedia
                </a>
                <a class="amp-modal-ecom-btn" href="https://shopee.co.id/frisianflagofficial" target="_blank">
                    shopee
                </a>                
                <a class="amp-modal-ecom-btn" href="https://www.lazada.co.id/shop/frisian-flag/" target="_blank">
                    Lazada
                </a>
                <a class="amp-modal-ecom-btn" href="https://www.bukalapak.com/frisian-flag-official-store-official" target="_blank">
                    Bukalapak
                </a>
                <a class="amp-modal-ecom-btn" href="https://www.klikindomaret.com/page/frisian-flag-official-store" target="_blank">
                    Klikindomaret
                </a>


                
              </div>
              <button class="close" on="tap:ecom-lightbox.close">X</button>
          </div>
      </div>
    </amp-lightbox> 
    
    {% if latest %}
        <!-- s:latest article -->
        <div class="list">
            <div class="img">
            {% if latest.featured_image %}
              <amp-img 
                  src="{{ latest.featured_image| mediathumb_resize('width', 720, 90)  }}"
                  srcset="{{ latest.featured_image| mediathumb_resize('width', 720, 90)  }} 640w,
                         {{ latest.featured_image| mediathumb_resize('width', 720, 90)  }} 320w"
                  width="160"
                  height="90"
                  layout="responsive"
                  alt="{{ latest.title }}">
                  {#<amp-img 
                  src="{{ latest.featured_image| media  }}"
                  srcset="{{ latest.featured_image| media }} 640w,
                         {{ latest.featured_image| media  }} 320w"
                  width="160"
                  height="90"
                  layout="responsive"
                  alt="{{ latest.title }}">#}
              </amp-img>
              </amp-img>
            {% else %}
              <amp-img 
                  src="http://placehold.it/703x545/797979/666666?text=No+Image"
                  srcset="http://placehold.it/703x545/797979/666666?text=No+Image 640w,
                         http://placehold.it/703x545/797979/666666?text=No+Image 320w"
                  width="160"
                  height="90"
                  layout="responsive"
                  alt="{{ latest.title }}">
              </amp-img>
            {% endif %}
            </div>
            <div class="info">
              <span class="label">Nutrient</span>
              | {{ latest.created_at.format('d M Y') }}
            </div>
            <a href="{{ 'our-milkpedia-amp-single'|page({"category-slug": record.slug, "slug": latest.slug}) }}" target="_self"><h3>{{ trans_pick(latest, 'title') }}</h3></a>
            <p>{{ trans_pick(latest, 'excerpt')|raw }}</p>
            <a href="{{ 'our-milkpedia-amp-single'|page({"category-slug": record.slug, "slug": latest.slug}) }}" target="_self" class="btn_more">{{ 'lebih-lanjut'|_ }}</a>
        </div>
       
        <!-- e:latest article -->
    {% endif %}
    <!-- button commerse -->
     
        <div class="wrapper-ecom">
            
            <div class="wrapper-ecom-2">
                <h4 class="ecom-title">Sedia Frisian Flag Pilihanmu Sekarang</h4>
                <amp-img  src="{{ 'button-ecommerce.png' | media }}" height="25" width="100" on="tap:ecom-lightbox" role="button" tabindex="0"/>
            </div>
        </div> 
    
     <amp-list  src="{{ url('/api/milkpedia') }}?slug={{ record.slug }}&is_amp=1&page={{ this.page.p }}"
     
      width="320"
      height="530"
      items="data.data"
      class="m1">
      <template type="amp-mustache">
       <div class="list2">
            <div class="img">
              <amp-img 
                  src="https://www.frisianflag.com/storage/app/media{% verbatim %}{{featured_image}}{% endverbatim %}"
                  width="160"
                  height="90"
                  layout="responsive"
                  alt="{% verbatim %} {{ title }} {% endverbatim %}">
              </amp-img>
            </div>
            
            <div class="text">
              <div class="info">
                <span class="label">MILKPEDIA</span>
              </div>
              <a href="/amp/milkpedia/{{ record.slug }}/{% verbatim %}{{slug}}" target="_self"><h3> {{title}} {% endverbatim  %}</h3></a>
            </div>
            <div class="clearfix"></div>
        </div>
      </template>
    </amp-list>

    <!-- s:paging -->
    <div class="stylepaging">
      <ul>
        {% if this.page.p != 1 %}
          <li><a href="{{ 'our-milkpedia-amp'|page({ "slug": record.slug }) }}?p={{ this.page.p - 1 }}">&laquo;</a></li>
        {% endif %}
        {% for i in this.page.min_p..this.page.max_p %}
          <li>
            <a href="{{ 'our-milkpedia-amp'|page({ "slug": record.slug }) }}?p={{ i }}" {{ i == this.page.p ? 'class="disable"' : '' }}>
              {{ i }}
            </a>
          </li>
        {% endfor %}
        {% if this.page.p != this.page.total_page %}
          <li><a href="{{ 'our-milkpedia-amp'|page({ "slug": record.slug }) }}?p={{ this.page.p - 1 }}">&raquo;</a></li>
        {% endif %}
      </ul>                       
      <div class="paging-info">Halaman {{ this.page.p }} Dari {{ this.page.total_page }}</div>
    </div>

   <!--  <form method="GET"
        action="{{ url('/api/milkpedia') }}?slug={{ record.slug }}&is_amp=1"
        action-xhr="{{ url('/api/milkpedia') }}?slug={{ record.slug }}&is_amp=1"
        target="_top"
        {% verbatim %}
        on="submit-success: AMP.setState({
                  productsState: {
                    items: productsState.items.concat(event.response.items)
                  },
                  product: {
                    page: product.page + 1,
                    hasMorePages: event.response.hasMorePages
                  }
                });">
        <input type="hidden"
          name="page"
          value="2"
          [value]="product.page">
        <input type="submit"
          value="Show more"
          class="ampstart-btn caps m1 show amp-button-custom"
          [class]="(product.hasMorePages == false ? 'hide' : 'ampstart-btn caps m1 mb3 show')">
        {% endverbatim  %}
      </form> -->
{% else %}
    {{ notFoundMessage }}
{% endif %}

{% put scripts %}
{% endput %}