title = "milkpedia category testing"
url = "/milkpedia-testing/:slug"
layout = "default"
is_hidden = 0

[viewBag]
localeUrl[en] = "/milkpedia-category-testing"

[builderDetails]
modelClass = "Definite\Milkpedia\Models\Category"
identifierValue = "{{ :slug }}"
modelKeyColumn = "slug"
displayColumn = "title"
notFoundMessage = "Record not found"
==
<?php
function onEnd() {
    // get the post component
     $cmsController = new Cms\Classes\Controller;   
   $slug    = $this->param('slug');
   
   if($slug != "kapan-dan-bagaimana-cara-minum-susu" &&
   $slug != "manfaat-minum-susu" &&
   $slug != "nutrisi-dan-kesehatan"){

    return Response::make( $cmsController->render("/404"), 404);
    
   }else{
    $_title = $this->page->components["builderDetails"]->record->attributes["title"];
    $_title_en = $this->page->components["builderDetails"]->record->attributes["title_en"];
    $_meta_description = $this->page->components["builderDetails"]->record->attributes["meta_description"];
    $_meta_keywords = $this->page->components["builderDetails"]->record->attributes["meta_keywords"];

    if($_title == "Kapan & Bagaimana Cara Minum Susu"){
        $this->page->title = "Cara dan Waktu Terbaik Minum Susu";
    } else {
        $this->page->title = $_title;
    }

    $this->page->meta_title = $this->page->components["builderDetails"]->record->attributes["meta_title"];
    $this->page->meta_description = $_meta_description;
    $this->page->meta_keywords = $_meta_keywords;
    
    $this->page->meta_title_en = $this->page->components["builderDetails"]->record->attributes["meta_title_en"];
    $this->page->meta_description_en = $this->page->components["builderDetails"]->record->attributes["meta_description_en"];
    $this->page->meta_keywords_en = $this->page->components["builderDetails"]->record->attributes["meta_keywords_en"];
    $this->page->amp_url = $this->pageUrl('our-milkpedia-amp', ['slug'=>$this->param('slug')]);
    $this->page->slug = $this->param('slug');
    }
}
?>
==
{% set record = builderDetails.record %}
{% set displayColumn = builderDetails.displayColumn %}
{% set notFoundMessage = builderDetails.notFoundMessage %}
<style>
        .banner-commerce {
            position : relative;
            display : flex;
            align-items : center;
            margin-top : 30px;
        }
        .banner-commerce .content {
            position : absolute;
            padding : 10px 50px;
        }
        .banner-commerce .content img {
            width : 100px;
        }
               .overlay-store {
                   visibility : hidden;
                   opacity : 0;
                   transition : 0.3s;
                   background : rgba(0,0,0,0.8);
                   height : 100vh;
                   width : 100%;
                   position : fixed;
                   top : 0;
                   display : flex !important;
                   align-items : center;
                   justify-content : center;
                   left : 0;
                   z-index : 1000;
               }.overlay-store.show {
                   opacity : 1;
                   visibility : visible;
               }
               .overlay-store .card {
                   position : relative;
                   width : 95%;
                   background : #0F4D9A;
                   border-radius : 20px;
               }
               .overlay-store .card-body {
                   padding : 20px;
               }
               @media (min-width : 768px){
                   .overlay-store .card {
                       width : 35%;
                   }
               }
               .overlay-store h4, .overlay-store a{
                   color : white !important;   
                   text-align : center;
               }
               .overlay-store a.btn-outline-light{
                   color : white !important;
                   border : 1px solid white;
                   margin-bottom : 10px;
                   width : 100%;
                   transition : 0.3s;
               }
               .overlay-store a.btn-outline-light:hover{
                   background : #2875D5 !important;
               }
               .overlay-store .btn-close {
                   background : white !important;
                   border : unset !important;
                   color : black;
                   text-align : center;
                   width : 30px !important;
                   height : 30px !important;
                   position : absolute;
                   right : -10px;
                   top : -10px;
                   border-radius : 50%;
                   font-weight : bold;
               }
        </style>
<h1 aria-hidden="true" class="seo-heading">{{ record.title }}</h1>

<div class="static-baner-pages tt">
    {% if this.page.slug == 'kapan-dan-bagaimana-cara-minum-susu' %}
        <div class="imgwrp hidden-xs">
            <img src="{{ 'assets/img/milkypedia/Kapan-dan-bagaimana-cara-minum-susu-Desktop.jpg'|theme }}" alt="Desktop Banner FF"/>
        </div>
        <div class="imgwrp visible-xs">
            <img src="{{ 'assets/img/milkypedia/Kapan-dan-bagaimana-cara-minum-susu-Mobile.jpg'|theme }}" alt="Mobile Banner FF"/> 
        </div>
    {% elseif this.page.slug == 'manfaat-minum-susu' %}
        <div class="imgwrp hidden-xs">
            <img src="{{ 'assets/img/milkypedia/Manfaat-Minum-Susu-Desktop.jpg'|theme }}" alt="Desktop Banner FF"/> 
        </div>
        <div class="imgwrp visible-xs">
            <img src="{{ 'assets/img/milkypedia/Manfaat-Minum-Susu-Mobile.jpg'|theme }}" alt="Mobile Banner FF"/> 
        </div>
    {% elseif this.page.slug == 'nutrisi-dan-kesehatan' %}        
        <div class="imgwrp hidden-xs">
            <img src="{{ 'assets/img/milkypedia/Nutrisi-dan-Kesehatan-Desktop.jpg'|theme }}" alt="Desktop Banner FF"/> 
        </div>
        <div class="imgwrp visible-xs">
            <img src="{{ 'assets/img/milkypedia/Nutrisi-dan-Kesehatan-Mobile.jpg'|theme }}" alt="Mobile Banner FF"/> 
        </div>
    {% else %}
        <div class="imgwrp hidden-xs"><img src="{{ 'assets/img/95-TAHUN-FF_desktop-banner.jpg'|theme }}" alt="Desktop Banner FF"/> </div>
        <div class="imgwrp visible-xs"><img src="{{ 'assets/img/95-TAHUN-FF_mobile-banner.jpg'|theme }}" alt="Mobile Banner FF"/> </div>
    {% endif %}
</div>
    {{key}}
<div class="container-menutab">
    <div class="container-one">
        <ul class="menutab-full">
            <li class="toggle visible-xs visible-sm"><a href="javascript:;" class="active">{{ record.title }}</a></li>
            {% for category in record.all %}
            <li>
                <a href="{{ category.slug }}" {% if category.slug == record.slug %} class="active" {% endif %}>
                    <span>
                        {{ trans_pick(category, 'title') }}
                    </span>
                </a>
            </li>            
            {% endfor %}
            <li><a href="/milkpedia/faq"><span>FAQ</span></a></li>
        </ul>
    </div>
</div>

<div id='main-section' class="test">
    <div class="col-md-12">
        <div class="breadcrumb">
            <div class="container-two">
                <ul>
                    <li>
                        <a href="{{ 'home'|page }}">{{ 'beranda'|_ }}</a>
                    </li>
                    <li>
                        <a href="#">Milkpedia</a>
                    </li>
                    <li>
                        <a href="{{ 'our-milkpedia'|page({ "slug": record.slug }) }}">
                            {{ trans_pick(record, 'title') }}
                        </a>
                    </li>
                    <li><a href="/milkpedia/faq">FAQ</a></li>
                </ul>
            </div>
        </div>
    </div>

    {% if record %}
        {% set milkpedias = record.posts.take(7) %}
        {% set latest = milkpedias.first() %}

        <div class="col-md-12">
            <div class="default-content">
                <div class="container-two">
                    <h3>{{ trans_pick(record, "title") }}</h3>
                    <p>{{ trans_pick(record, "description") | raw}}</p>
                </div>
            </div>
        </div>
        
        <div class="col-md-12">
            <div class="container-two banner-commerce">
                <img src="{{ 'Banner/ecommerce-banner.png' | media  }}" alt="ecommerce-banner"/>
                <div class="content">
                    <h4>Sedia Frisian Flag<br/>Pilihanmu Sekarang</h4>
                   <a href="javascript:void(0)" data-target="#popup-ecommerce" class="btn-modal">
                       <img loading="lazy" src="{{ 'button-ecommerce.png' | media }}" />
                   </a>
                </div>
            </div>
        </div>

        {% if latest %}
            <div class="col-md-6" style="margin-top: 40px">
                <div class="wrp-halfcontent">
                    <div class="imgfull">
                        {% if latest.featured_image %}
                            <img src="{{ latest.featured_image| mediathumb_resize('width', 720, 90)  }}" alt="{{ latest.title }}"/> 
                            {#<img src="{{ latest.featured_image | media  }}" alt="{{ latest.title }}"/>#}
                        {% else %}
                            <img src="http://placehold.it/703x545/797979/666666?text=No+Image" alt="No Image"/>
                        {% endif %}
                    </div>
                </div>
            </div>
            <div class="col-md-6" style="margin-top: 40px">
                <div class="content-fullhalf">
                    <div class="date">
                        <label>Nutrient</label> | {{ latest.created_at.format('d M Y') }}
                    </div>
                    <div class="content">
                        <h3>{{ trans_pick(latest, 'title') }}</h3>
                        <p>{{ trans_pick(latest, 'excerpt')|raw }}</p>

                        <a href="{{ 'our-milkpedia-single'|page({"category-slug": record.slug, "slug": latest.slug}) }}" class="button btnblue" style="text-transform: uppercase">{{ 'lebih-lanjut'|_ }}</a>
                    </div>
                </div>
            </div>
        {% endif %}

        <div id="ourmilkpedia" class="section section_card clearfix">
            {% for milkpedia in milkpedias %}
              {% if loop.index0 != 0 %}
                <div class="col-sm-4 itemhomefade">
                    <div class="card card_featured">
                        <div class="card__thumbnail">
                            <div class="card__image">
                                {% if milkpedia.featured_image %}
                                    <img src="{{ milkpedia.featured_image| mediathumb_resize('width', 640, 90)  }}" alt="{{ milkpedia.title }}"/>
                                    {#<img src="{{ milkpedia.featured_image| media  }}" alt="{{ milkpedia.title }}"/>#}
                                {% else %}
                                    <img src="http://placehold.it/600x600/797979/666666?text=No+Image" alt="No Image"/>
                                {% endif %}
                            </div>

                            <div class="card__meta">
                                <header class="card__head">
                                    <h3><a href="{{ 'our-milkpedia-single'|page({"category-slug": milkpedia.category.slug, "slug": milkpedia.slug}) }}">{{ milkpedia.title }}</a></h3>
                                </header>
                                <a href="{{ 'our-milkpedia-single'|page({"category-slug": milkpedia.category.slug, "slug": milkpedia.slug}) }}" class="button hidden-xs">{{ 'lebih-lanjut'|_ }}</a>
                            </div>
                        </div>
                    </div>
                </div>
              {% endif %}
            {% endfor %}
        </div>

        <div id="result-container" style="clear: both;">
            <div class="col-sm-4" v-for="(row, index) in posts">
                    <div class="card card_featured">
                        <div class="card__thumbnail">
                            <div class="card__image" :style="'background-image: url(/storage/app/media' + encodeURI(row.featured_image) + ');'">
                                <img :src="'/storage/app/media' + row.featured_image" :alt="row.title"/>
                            </div>

                            <div class="card__meta">
                                <header class="card__head">
                                    <h3><a :href="'/milkpedia/{{ record.slug }}/' + row.slug" v-html="row.title"></a></h3>
                                </header>
                                <a :href="'/milkpedia/{{ record.slug }}/' + row.slug" class="button hidden-xs">{{ 'lebih-lanjut'|_ }}</a>
                            </div>
                        </div>
                    </div>
                </div>

            <div class="text-center loader" v-if="isLoading"><img src="{{ 'assets/img/loader.gif'|theme }}" alt="Loader"></div>
        </div>

    {% else %}
        {{ notFoundMessage }}
    {% endif %}

</div> <!-- end mainsection -->

<div id="popup-ecommerce" class="overlay-store">
   <div class="card">
    <button class="btn-close">x</button>
        <div class="card-body">
            <h4>Temukan Produk Kami di:</h4>
                <a class="btn btn-outline-light btn-commerce" href="https://www.tokopedia.com/frisian-flag?utm_source=others&utm_medium=brand&utm_campaign=ao_frisianflag_221121_311222" target="_blank">
                    Tokopedia
                </a>
                <a class="btn btn-outline-light btn-commerce" href="https://shopee.co.id/frisianflagofficial" target="_blank">
                    Shopee
                </a>
                <a class="btn btn-outline-light btn-commerce" href="https://www.lazada.co.id/shop/frisian-flag" target="_blank">
                    Lazada
                </a>
                <a class="btn btn-outline-light btn-commerce" href="https://www.bukalapak.com/frisian-flag-official-store-official" target="_blank">
                    Bukalapak
                </a>
                <a class="btn btn-outline-light btn-commerce" href="https://www.klikindomaret.com/page/frisian-flag-official-store" target="_blank">
                    Klikindomaret
                </a>
                
        </div>
   </div>
</div>
{% put scripts %}
<script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/vue-resource@1.5.0"></script>
<script>
    'use strict';

    (function() {

        // Init
        var app = new Vue({
            el: '#result-container',
            data: {
                canLoadmore: true,
                isLoading: false,
                containerTop: 0,
                page: 2,
                posts: []
            },
            mounted: function()
            {
                // Set window scroll to top
                var button = $('.btn-modal')
                button.click(function () {
                    var target = $(this).data('target')
                    $(target).addClass('show')
                })
                
                var overlay = $('.overlay-store')
                var close_btn = $('.overlay-store .btn-close')
                close_btn.click(function () {
                    overlay.removeClass('show')    
                })
            
                window.scrollTo(0, 0);

                // Init
                var $container = document.getElementById('result-container');
                var containerRect = $container.getBoundingClientRect();
                var containerTop = Math.floor(containerRect.top);
                var self = this;
                
                // Setup
                self.containerTop = containerTop;

                // Window scroll
                window.addEventListener('scroll', function(e) {
                    // Get window top
                    var windowTop = window.pageYOffset;
                    
                    if (windowTop > (self.containerTop + $container.scrollHeight + 200) && self.canLoadmore)
                    {
                        // Set loading
                        self.isLoading = true;

                        // Call API
                        self.$http.get('{{ url("/api/milkpedia") }}', {
                            params: {
                                slug: '{{ record.slug }}',
                                page: self.page
                            }
                        }).then(self.loadData);

                        // Set can loadmore to false
                        self.canLoadmore = false;
                    }
                });
            },
            computed: {},
            methods: {
                loadData: function(res)
                {
                    // Init
                    var response = res.body;
                    var self = this;
                    var result = response.data;
                    var $container = document.getElementById('result-container');

                    // Check data
                    if (result && result.data.length > 0)
                    {
                        // Set Data
                        result.data.forEach(function(row) {
                            self.posts.push(row);
                        });

                        // Check next page
                        if (result.next_page_url)
                        {
                            // Increase page
                            self.page++;
                            
                            // Set can load more
                            self.canLoadmore = true;
                        }

                        // Hide Loading
                        self.isLoading = false;
                    }
                    else
                    {
                        self.isLoading = false;
                    }
                }
            }
        });

    })();
</script>
{% endput %}